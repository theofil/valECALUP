//compile me with: g++ printArraysPhaseI.C -o printArraysPhaseI.exec `root-config --glibs --cflags`
#include <iostream>
#include <fstream>
#include <math.h>

using namespace std;

double EBShape[500];
double EEShape[500];
double APDShape[500];


void loadShapes();



int main()
{
    loadShapes();

    ofstream shapeEBFile;
    shapeEBFile.open("EB_SimPulseShape.txt");

    for(int i=0; i<500; ++i)
    {
	 shapeEBFile <<EBShape[i] << endl;
    }
    shapeEBFile.close();

    ofstream shapeEEFile;
    shapeEEFile.open("EE_SimpulseShape.txt");

    for(int i=0; i<500; ++i)
    {
	 shapeEEFile <<EEShape[i] << endl;
    }
    shapeEEFile.close();

    ofstream shapeAPDFile;
    shapeAPDFile.open("APD_SimPulseShape.txt");

    for(int i=0; i<500; ++i)
    {
	 shapeAPDFile <<APDShape[i] << endl;
    }
    shapeAPDFile.close();

    return 0;
}


void loadShapes()
{

   // EB array
   for( unsigned int i ( 250 ) ; i != 500 ; ++i )
   {
      EBShape[i] = exp(2.39735 - 0.0151053* ((double)i+1.0));
   }


   EBShape[0] = 6.94068e-05 ; 
   EBShape[1] = -5.03304e-05 ; 
   EBShape[2] = -2.13404e-05 ; 
   EBShape[3] = 6.017e-05 ; 
   EBShape[4] = 2.01697e-05 ; 
   EBShape[5] = 0.000114845 ; 
   EBShape[6] = 2.13998e-05 ; 
   EBShape[7] = 2.74476e-05 ; 
   EBShape[8] = 5.2824e-05 ; 
   EBShape[9] = 8.754e-05 ; 
   EBShape[10] = 2.95346e-06 ; 
   EBShape[11] = -7.58699e-05 ; 
   EBShape[12] = -2.72224e-05 ; 
   EBShape[13] = 3.10997e-06 ; 
   EBShape[14] = -3.97771e-05 ; 
   EBShape[15] = -1.06916e-05 ; 
   EBShape[16] = -0.000113865 ; 
   EBShape[17] = 6.05044e-05 ; 
   EBShape[18] = -5.81202e-05 ; 
   EBShape[19] = -6.58974e-06 ; 
   EBShape[20] = 5.37494e-05 ; 
   EBShape[21] = -0.000123729 ; 
   EBShape[22] = 7.50938e-06 ; 
   EBShape[23] = -1.35628e-05 ; 
   EBShape[24] = 8.33725e-05 ; 
   EBShape[25] = 3.19299e-05 ; 
   EBShape[26] = -3.09232e-05 ; 
   EBShape[27] = -7.0086e-05 ; 
   EBShape[28] = 1.78937e-06 ; 
   EBShape[29] = -2.20365e-05 ; 
   EBShape[30] = 7.68054e-05 ; 
   EBShape[31] = -2.5368e-05 ; 
   EBShape[32] = 5.67291e-06 ; 
   EBShape[33] = 5.87096e-05 ; 
   EBShape[34] = -2.62771e-06 ; 
   EBShape[35] = 4.31832e-05 ; 
   EBShape[36] = 8.33616e-06 ; 
   EBShape[37] = 7.27813e-05 ; 
   EBShape[38] = 7.6159e-05 ; 
   EBShape[39] = -1.60446e-05 ; 
   EBShape[40] = -4.12127e-06 ; 
   EBShape[41] = -5.93381e-05 ; 
   EBShape[42] = 1.61444e-05 ; 
   EBShape[43] = -5.49559e-05 ; 
   EBShape[44] = 5.55254e-05 ; 
   EBShape[45] = 3.32251e-05 ; 
   EBShape[46] = -3.15897e-05 ; 
   EBShape[47] = 7.86588e-05 ; 
   EBShape[48] = -2.9704e-05 ; 
   EBShape[49] = 5.66838e-05 ; 
   EBShape[50] = 2.85281e-05 ; 
   EBShape[51] = -3.02436e-05 ; 
   EBShape[52] = -4.16265e-05 ; 
   EBShape[53] = -1.63191e-05 ; 
   EBShape[54] = 6.61193e-05 ; 
   EBShape[55] = 9.23766e-05 ; 
   EBShape[56] = 6.68903e-05 ; 
   EBShape[57] = -3.20994e-05 ; 
   EBShape[58] = 0.00011082 ; 
   EBShape[59] = -4.07997e-05 ; 
   EBShape[60] = -8.29046e-06 ; 
   EBShape[61] = -7.42197e-05 ; 
   EBShape[62] = -1.64386e-05 ; 
   EBShape[63] = 1.02508e-05 ; 
   EBShape[64] = 7.10995e-06 ; 
   EBShape[65] = -5.87486e-05 ; 
   EBShape[66] = -0.000101201 ; 
   EBShape[67] = 1.62003e-05 ; 
   EBShape[68] = -2.53093e-05 ; 
   EBShape[69] = 2.65239e-05 ; 
   EBShape[70] = -2.68722e-05 ; 
   EBShape[71] = -4.02001e-05 ; 
   EBShape[72] = 5.0674e-05 ; 
   EBShape[73] = -1.75884e-05 ; 
   EBShape[74] = 4.7902e-05 ; 
   EBShape[75] = -1.01079e-05 ; 
   EBShape[76] = 1.08427e-05 ; 
   EBShape[77] = -0.000112906 ; 
   EBShape[78] = 3.33076e-05 ; 
   EBShape[79] = 0.000181201 ; 
   EBShape[80] = 0.000426875 ; 
   EBShape[81] = 0.00114222 ; 
   EBShape[82] = 0.00237804 ; 
   EBShape[83] = 0.00541858 ; 
   EBShape[84] = 0.0089021 ; 
   EBShape[85] = 0.0149157 ; 
   EBShape[86] = 0.0231397 ; 
   EBShape[87] = 0.0344671 ; 
   EBShape[88] = 0.0471013 ; 
   EBShape[89] = 0.0625517 ; 
   EBShape[90] = 0.0857351 ; 
   EBShape[91] = 0.108561 ; 
   EBShape[92] = 0.133481 ; 
   EBShape[93] = 0.163557 ; 
   EBShape[94] = 0.200243 ; 
   EBShape[95] = 0.225919 ; 
   EBShape[96] = 0.269213 ; 
   EBShape[97] = 0.302929 ; 
   EBShape[98] = 0.342722 ; 
   EBShape[99] = 0.378522 ; 
   EBShape[100] = 0.436563 ; 
   EBShape[101] = 0.467581 ; 
   EBShape[102] = 0.510133 ; 
   EBShape[103] = 0.550063 ; 
   EBShape[104] = 0.583509 ; 
   EBShape[105] = 0.619187 ; 
   EBShape[106] = 0.653245 ; 
   EBShape[107] = 0.686101 ; 
   EBShape[108] = 0.721178 ; 
   EBShape[109] = 0.745129 ; 
   EBShape[110] = 0.774163 ; 
   EBShape[111] = 0.799011 ; 
   EBShape[112] = 0.822177 ; 
   EBShape[113] = 0.838315 ; 
   EBShape[114] = 0.858847 ; 
   EBShape[115] = 0.875559 ; 
   EBShape[116] = 0.891294 ; 
   EBShape[117] = 0.90537 ; 
   EBShape[118] = 0.919617 ; 
   EBShape[119] = 0.930632 ; 
   EBShape[120] = 0.936216 ; 
   EBShape[121] = 0.947739 ; 
   EBShape[122] = 0.955306 ; 
   EBShape[123] = 0.961876 ; 
   EBShape[124] = 0.968124 ; 
   EBShape[125] = 0.97327 ; 
   EBShape[126] = 0.977513 ; 
   EBShape[127] = 0.984885 ; 
   EBShape[128] = 0.986497 ; 
   EBShape[129] = 0.990039 ; 
   EBShape[130] = 0.994798 ; 
   EBShape[131] = 0.994884 ; 
   EBShape[132] = 0.99795 ; 
   EBShape[133] = 0.99834 ; 
   EBShape[134] = 0.999607 ; 
   EBShape[135] = 1 ; 
   EBShape[136] = 0.999047 ; 
   EBShape[137] = 0.998745 ; 
   EBShape[138] = 0.999219 ; 
   EBShape[139] = 0.99814 ; 
   EBShape[140] = 0.995082 ; 
   EBShape[141] = 0.992449 ; 
   EBShape[142] = 0.990418 ; 
   EBShape[143] = 0.985032 ; 
   EBShape[144] = 0.982308 ; 
   EBShape[145] = 0.978696 ; 
   EBShape[146] = 0.975656 ; 
   EBShape[147] = 0.971027 ; 
   EBShape[148] = 0.964811 ; 
   EBShape[149] = 0.959428 ; 
   EBShape[150] = 0.95096 ; 
   EBShape[151] = 0.947428 ; 
   EBShape[152] = 0.9419 ; 
   EBShape[153] = 0.933223 ; 
   EBShape[154] = 0.926482 ; 
   EBShape[155] = 0.922172 ; 
   EBShape[156] = 0.912777 ; 
   EBShape[157] = 0.907388 ; 
   EBShape[158] = 0.897289 ; 
   EBShape[159] = 0.891889 ; 
   EBShape[160] = 0.882056 ; 
   EBShape[161] = 0.873382 ; 
   EBShape[162] = 0.865442 ; 
   EBShape[163] = 0.860032 ; 
   EBShape[164] = 0.85202 ; 
   EBShape[165] = 0.841013 ; 
   EBShape[166] = 0.833802 ; 
   EBShape[167] = 0.825259 ; 
   EBShape[168] = 0.815013 ; 
   EBShape[169] = 0.807465 ; 
   EBShape[170] = 0.799428 ; 
   EBShape[171] = 0.792165 ; 
   EBShape[172] = 0.783088 ; 
   EBShape[173] = 0.773392 ; 
   EBShape[174] = 0.764982 ; 
   EBShape[175] = 0.752174 ; 
   EBShape[176] = 0.746487 ; 
   EBShape[177] = 0.737678 ; 
   EBShape[178] = 0.727396 ; 
   EBShape[179] = 0.718692 ; 
   EBShape[180] = 0.712737 ; 
   EBShape[181] = 0.702738 ; 
   EBShape[182] = 0.69559 ; 
   EBShape[183] = 0.684389 ; 
   EBShape[184] = 0.677989 ; 
   EBShape[185] = 0.667643 ; 
   EBShape[186] = 0.659009 ; 
   EBShape[187] = 0.650217 ; 
   EBShape[188] = 0.644479 ; 
   EBShape[189] = 0.636017 ; 
   EBShape[190] = 0.625257 ; 
   EBShape[191] = 0.618507 ; 
   EBShape[192] = 0.609798 ; 
   EBShape[193] = 0.600097 ; 
   EBShape[194] = 0.592788 ; 
   EBShape[195] = 0.584895 ; 
   EBShape[196] = 0.578228 ; 
   EBShape[197] = 0.569299 ; 
   EBShape[198] = 0.560576 ; 
   EBShape[199] = 0.552404 ; 
   EBShape[200] = 0.541405 ; 
   EBShape[201] = 0.536271 ; 
   EBShape[202] = 0.528734 ; 
   EBShape[203] = 0.519813 ; 
   EBShape[204] = 0.512264 ; 
   EBShape[205] = 0.507001 ; 
   EBShape[206] = 0.49828 ; 
   EBShape[207] = 0.492416 ; 
   EBShape[208] = 0.483181 ; 
   EBShape[209] = 0.477907 ; 
   EBShape[210] = 0.469623 ; 
   EBShape[211] = 0.462528 ; 
   EBShape[212] = 0.455099 ; 
   EBShape[213] = 0.45055 ; 
   EBShape[214] = 0.443576 ; 
   EBShape[215] = 0.435364 ; 
   EBShape[216] = 0.429789 ; 
   EBShape[217] = 0.422724 ; 
   EBShape[218] = 0.415621 ; 
   EBShape[219] = 0.409469 ; 
   EBShape[220] = 0.40401 ; 
   EBShape[221] = 0.398121 ; 
   EBShape[222] = 0.391079 ; 
   EBShape[223] = 0.384414 ; 
   EBShape[224] = 0.378214 ; 
   EBShape[225] = 0.369851 ; 
   EBShape[226] = 0.365966 ; 
   EBShape[227] = 0.359865 ; 
   EBShape[228] = 0.353505 ; 
   EBShape[229] = 0.347899 ; 
   EBShape[230] = 0.343829 ; 
   EBShape[231] = 0.337585 ; 
   EBShape[232] = 0.333089 ; 
   EBShape[233] = 0.326289 ; 
   EBShape[234] = 0.322249 ; 
   EBShape[235] = 0.316079 ; 
   EBShape[236] = 0.31061 ; 
   EBShape[237] = 0.305426 ; 
   EBShape[238] = 0.301885 ; 
   EBShape[239] = 0.296753 ; 
   EBShape[240] = 0.290931 ; 
   EBShape[241] = 0.286877 ; 
   EBShape[242] = 0.281831 ; 
   EBShape[243] = 0.276633 ; 
   EBShape[244] = 0.272283 ; 
   EBShape[245] = 0.268069 ; 
   EBShape[246] = 0.26399 ; 
   EBShape[247] = 0.258457 ; 
   EBShape[248] = 0.253549 ; 
   EBShape[249] = 0.249493 ; 

   // EE Shape

   for( unsigned int i ( 250 ) ; i != 500 ; ++i )
   {
     EEShape[i] = exp(2.63163e-01 - 1.37795e-02*(i - 151.0));
   }

   EEShape[0] = 9.09091e-05;
   EEShape[1] = 9.96016e-05;
   EEShape[2] = 8.08219e-05;
   EEShape[3] = 0.000119685;
   EEShape[4] = 9.56522e-05;
   EEShape[5] = 0.000143969;
   EEShape[6] = 0.000101639;
   EEShape[7] = 0.000115789;
   EEShape[8] = 8.31461e-05;
   EEShape[9] = 0.000117091;
   EEShape[10] = 0.000141224;
   EEShape[11] = 5.38745e-05;
   EEShape[12] = 0.000158079;
   EEShape[13] = 0.000104906;
   EEShape[14] = 7.91946e-05;
   EEShape[15] = 8e-05;
   EEShape[16] = 0.000119703;
   EEShape[17] = 9.96516e-05;
   EEShape[18] = 8.82591e-05;
   EEShape[19] = 0.000146988;
   EEShape[20] = 0.000120588;
   EEShape[21] = 9.89474e-05;
   EEShape[22] = 0.000116788;
   EEShape[23] = 0.000151292;
   EEShape[24] = 0.000108434;
   EEShape[25] = 0.000108651;
   EEShape[26] = 8.5259e-05;
   EEShape[27] = 0.000146575;
   EEShape[28] = 8.66142e-05;
   EEShape[29] = 0.000103679;
   EEShape[30] = 0.000153307;
   EEShape[31] = 7.80328e-05;
   EEShape[32] = 8.42105e-05;
   EEShape[33] = 0.000114607;
   EEShape[34] = 6.90909e-05;
   EEShape[35] = 9.22449e-05;
   EEShape[36] = 8.92989e-05;
   EEShape[37] = 0.000105677;
   EEShape[38] = 9.58491e-05;
   EEShape[39] = 0.000107383;
   EEShape[40] = 8.85714e-05;
   EEShape[41] = 0.000119703;
   EEShape[42] = 0.000141463;
   EEShape[43] = 0.000122267;
   EEShape[44] = 6.0241e-05;
   EEShape[45] = 0.000120588;
   EEShape[46] = 0.000115789;
   EEShape[47] = 0.000121168;
   EEShape[48] = 8.04428e-05;
   EEShape[49] = 9.39759e-05;
   EEShape[50] = 3.391e-05;
   EEShape[51] = -7.72908e-05;
   EEShape[52] = 5.61644e-05;
   EEShape[53] = 0.000181102;
   EEShape[54] = -3.67893e-05;
   EEShape[55] = 6.45914e-05;
   EEShape[56] = 2.68852e-05;
   EEShape[57] = -1.57895e-05;
   EEShape[58] = -2.47191e-05;
   EEShape[59] = -5.30909e-05;
   EEShape[60] = -1.06122e-05;
   EEShape[61] = -3.69004e-06;
   EEShape[62] = 5.85153e-05;
   EEShape[63] = -3.54717e-05;
   EEShape[64] = -9.39597e-06;
   EEShape[65] = 5e-05;
   EEShape[66] = -3.19703e-05;
   EEShape[67] = 3.69338e-05;
   EEShape[68] = -0.000169231;
   EEShape[69] = -4.09639e-05;
   EEShape[70] = -1.61765e-05;
   EEShape[71] = -8.21053e-05;
   EEShape[72] = 6.86131e-05;
   EEShape[73] = -6.12546e-05;
   EEShape[74] = -6.50602e-05;
   EEShape[75] = 2.56055e-05;
   EEShape[76] = -3.90438e-05;
   EEShape[77] = -5.89041e-05;
   EEShape[78] = 0.000195276;
   EEShape[79] = -7.29097e-05;
   EEShape[80] = 1.32296e-05;
   EEShape[81] = 3.27869e-06;
   EEShape[82] = -6.31579e-05;
   EEShape[83] = -3.37079e-05;
   EEShape[84] = 5.16364e-05;
   EEShape[85] = -4.97959e-05;
   EEShape[86] = 8.92989e-05;
   EEShape[87] = 0.000561572;
   EEShape[88] = 0.00171698;
   EEShape[89] = 0.0035906;
   EEShape[90] = 0.00742143;
   EEShape[91] = 0.01249;
   EEShape[92] = 0.020922;
   EEShape[93] = 0.030336;
   EEShape[94] = 0.043588;
   EEShape[95] = 0.0593529;
   EEShape[96] = 0.0764947;
   EEShape[97] = 0.0958978;
   EEShape[98] = 0.11567;
   EEShape[99] = 0.137087;
   EEShape[100] = 0.160643;
   EEShape[101] = 0.188973;
   EEShape[102] = 0.218062;
   EEShape[103] = 0.240682;
   EEShape[104] = 0.265773;
   EEShape[105] = 0.293327;
   EEShape[106] = 0.320832;
   EEShape[107] = 0.348689;
   EEShape[108] = 0.374411;
   EEShape[109] = 0.403575;
   EEShape[110] = 0.431147;
   EEShape[111] = 0.458644;
   EEShape[112] = 0.488217;
   EEShape[113] = 0.515254;
   EEShape[114] = 0.53902;
   EEShape[115] = 0.566819;
   EEShape[116] = 0.589752;
   EEShape[117] = 0.615587;
   EEShape[118] = 0.63808;
   EEShape[119] = 0.664137;
   EEShape[120] = 0.687959;
   EEShape[121] = 0.707379;
   EEShape[122] = 0.726826;
   EEShape[123] = 0.747043;
   EEShape[124] = 0.762952;
   EEShape[125] = 0.781342;
   EEShape[126] = 0.799515;
   EEShape[127] = 0.818559;
   EEShape[128] = 0.832301;
   EEShape[129] = 0.846658;
   EEShape[130] = 0.860791;
   EEShape[131] = 0.874009;
   EEShape[132] = 0.886242;
   EEShape[133] = 0.896982;
   EEShape[134] = 0.908713;
   EEShape[135] = 0.9189;
   EEShape[136] = 0.9283;
   EEShape[137] = 0.938453;
   EEShape[138] = 0.945995;
   EEShape[139] = 0.95186;
   EEShape[140] = 0.958876;
   EEShape[141] = 0.963283;
   EEShape[142] = 0.968989;
   EEShape[143] = 0.972846;
   EEShape[144] = 0.977824;
   EEShape[145] = 0.981341;
   EEShape[146] = 0.982743;
   EEShape[147] = 0.984082;
   EEShape[148] = 0.986609;
   EEShape[149] = 0.985925;
   EEShape[150] = 0.984707;
   EEShape[151] = 0.981384;
   EEShape[152] = 0.980941;
   EEShape[153] = 0.980132;
   EEShape[154] = 0.978176;
   EEShape[155] = 0.975987;
   EEShape[156] = 0.973396;
   EEShape[157] = 0.970395;
   EEShape[158] = 0.967422;
   EEShape[159] = 0.96346;
   EEShape[160] = 0.959622;
   EEShape[161] = 0.955396;
   EEShape[162] = 0.950846;
   EEShape[163] = 0.945995;
   EEShape[164] = 0.940835;
   EEShape[165] = 0.935373;
   EEShape[166] = 0.929544;
   EEShape[167] = 0.923836;
   EEShape[168] = 0.91787;
   EEShape[169] = 0.910812;
   EEShape[170] = 0.903924;
   EEShape[171] = 0.897669;
   EEShape[172] = 0.89127;
   EEShape[173] = 0.884613;
   EEShape[174] = 0.878051;
   EEShape[175] = 0.867734;
   EEShape[176] = 0.856756;
   EEShape[177] = 0.848477;
   EEShape[178] = 0.842189;
   EEShape[179] = 0.833787;
   EEShape[180] = 0.825903;
   EEShape[181] = 0.817931;
   EEShape[182] = 0.8102;
   EEShape[183] = 0.802771;
   EEShape[184] = 0.79388;
   EEShape[185] = 0.785348;
   EEShape[186] = 0.777295;
   EEShape[187] = 0.767854;
   EEShape[188] = 0.759619;
   EEShape[189] = 0.752358;
   EEShape[190] = 0.743394;
   EEShape[191] = 0.736674;
   EEShape[192] = 0.726982;
   EEShape[193] = 0.719321;
   EEShape[194] = 0.708937;
   EEShape[195] = 0.700003;
   EEShape[196] = 0.693202;
   EEShape[197] = 0.685961;
   EEShape[198] = 0.676889;
   EEShape[199] = 0.670513;
   EEShape[200] = 0.658788;
   EEShape[201] = 0.648343;
   EEShape[202] = 0.639381;
   EEShape[203] = 0.632761;
   EEShape[204] = 0.623614;
   EEShape[205] = 0.616164;
   EEShape[206] = 0.607884;
   EEShape[207] = 0.601437;
   EEShape[208] = 0.593944;
   EEShape[209] = 0.585817;
   EEShape[210] = 0.577248;
   EEShape[211] = 0.570328;
   EEShape[212] = 0.56147;
   EEShape[213] = 0.553509;
   EEShape[214] = 0.548765;
   EEShape[215] = 0.539964;
   EEShape[216] = 0.53343;
   EEShape[217] = 0.525787;
   EEShape[218] = 0.519868;
   EEShape[219] = 0.510817;
   EEShape[220] = 0.503274;
   EEShape[221] = 0.498478;
   EEShape[222] = 0.493058;
   EEShape[223] = 0.484176;
   EEShape[224] = 0.479896;
   EEShape[225] = 0.469998;
   EEShape[226] = 0.462893;
   EEShape[227] = 0.45576;
   EEShape[228] = 0.450375;
   EEShape[229] = 0.442683;
   EEShape[230] = 0.437887;
   EEShape[231] = 0.430736;
   EEShape[232] = 0.427216;
   EEShape[233] = 0.420775;
   EEShape[234] = 0.41485;
   EEShape[235] = 0.407769;
   EEShape[236] = 0.403546;
   EEShape[237] = 0.397028;
   EEShape[238] = 0.389534;
   EEShape[239] = 0.388569;
   EEShape[240] = 0.380296;
   EEShape[241] = 0.375312;
   EEShape[242] = 0.369457;
   EEShape[243] = 0.365884;
   EEShape[244] = 0.358889;
   EEShape[245] = 0.353344;
   EEShape[246] = 0.350364;
   EEShape[247] = 0.347136;
   EEShape[248] = 0.33872;
   EEShape[249] = 0.336706;

   // APD Shape
   double m_tStart=74.5;
   double m_tau=40.5;
   for( unsigned int i ( 0 ) ; i != 500 ; ++i )
   {
      const double ctime ( ( 1.*i + 0.5 - m_tStart )/m_tau ) ;
      APDShape[i] = ( 0 > ctime ? 0 : ctime * exp( 1. - ctime ) ) ;
   }
}


